\usepackage{amsmath} % JIC.
\usepackage{algorithmicx}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{siunitx}
\usepackage{commath}

\usepackage{preamble/vector} % local vector.sty for bold Greek math letters


%% Julia code blocks using JuliaMono
\input{julia_font}
\input{julia_listings}

\lstdefinelanguage{JuliaLocal}[]{Julia}{ % inherit Julia lang. to add keywords
    morekeywords=[3]{initialize!, transition!, evaluate!, distance, isevent, isterminal, environment, evaluation_schedule, eachcol, model_elite_set!, fit, ce_surrogate, sierra, paraboloid},
    morekeywords=[2]{Nothing, Tuple, Real, Bool, Simulation, BlackBox, GrayBox, Sampleable, Environment, MvNormal},
    morekeywords=[1]{function, abstract, type, end},
    morekeywords=[2]{CrossEntropyVariants, Distributions}, % define more types and modules
}


%%% Mathematical operators (from mathematics.tex)
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\SD}{SD}
\DeclareMathOperator{\Ber}{Ber}
\DeclareMathOperator{\Bin}{Bin}
\DeclareMathOperator{\Poi}{Poi}
\DeclareMathOperator{\Geo}{Geo}
\DeclareMathOperator{\NegBin}{NegBin}
\DeclareMathOperator{\Uni}{Uni}
\DeclareMathOperator{\Exp}{Exp}
\DeclareMathOperator{\Dir}{Dir}
\newcommand*\Eval[1]{\left.#1\right\rvert} % derivative/integration evaluation bar |
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\BetaDistribution}{Beta}
\DeclareMathOperator{\Beta}{Beta}
\DeclareMathOperator{\GammaDist}{Gamma}
\DeclareMathOperator{\Gumbel}{Gumbel}
\DeclareMathOperator{\Std}{Std}
% \DeclareMathOperator{\Dirichlet}{Dir}
\DeclareMathOperator{\Train}{\mathcal{D}_{\text{train}}}
\DeclareMathOperator{\Dtrain}{\mathcal{D}_{\text{train}}}
% \newcommand{\Dtrain}{\mathcal{D}_\text{train}}
\DeclareMathOperator{\TrainLoss}{TrainLoss}
\DeclareMathOperator{\Loss}{Loss}
\DeclareMathOperator{\ZeroOneLoss}{Loss_{0\text{-}1}}
\DeclareMathOperator{\SquaredLoss}{Loss_{\text{squared}}}
\DeclareMathOperator{\AbsDevLoss}{Loss_{\text{absdev}}}
\DeclareMathOperator{\HingeLoss}{Loss_{\text{hinge}}}
\DeclareMathOperator{\LogisticLoss}{Loss_{\text{logistic}}}
\newcommand{\bfw}{\mathbf{w}}
\newcommand{\bbI}{\mathbb{I}}
\newcommand{\E}{\mathbb{E}}
\DeclareMathOperator{\Miss}{Miss}
\DeclareMathOperator{\sgn}{sgn}
\newcommand{\1}{\mathbb{1}}
% \newcommand{\R}{\mathbb{R}}
\renewcommand{\v}{\mathbf{v}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\w}{\mathbf{w}}
\newcommand{\h}{\mathbf{h}}
\newcommand{\M}{\mathbf{M}}
\newcommand{\m}{\mathbf{m}}
\newcommand{\B}{\mathbf{B}}
\newcommand{\e}{\mathbf{e}}
\newcommand{\bfE}{\mathbf{E}}
\newcommand{\surrogate}{\hat{S}} % Surrogate model (\mathcal{S})
\newcommand{\Sierra}{\mathbf{M}_\mathcal{S}}

\newcommand{\opt}{*}
\DeclareMathOperator{\States}{States}
\DeclareMathOperator{\StartState}{s_{\text{state}}}
\DeclareMathOperator{\Actions}{Actions}
\DeclareMathOperator{\Reward}{Reward}
\DeclareMathOperator{\IsEnd}{IsEnd}
\DeclareMathOperator{\Cost}{Cost}
\DeclareMathOperator{\FutureCost}{FutureCost}
\DeclareMathOperator{\Succ}{Succ}

% From tufte_algorithms_book.tex
\usepackage{mathtools}
\DeclarePairedDelimiter{\paren}{\lparen}{\rparen}
\DeclarePairedDelimiter{\brock}{\lbrack}{\rbrack}
\DeclarePairedDelimiter{\curly}{\{}{\}}
% \DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
% \DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\anglebrackets}{\langle}{\rangle}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\card}{|}{|}

\newcommand{\minimize}{\operatornamewithlimits{minimize}}
\newcommand{\maximize}{\operatornamewithlimits{maximize}}
\newcommand{\supremum}{\operatornamewithlimits{supremum}}
\newcommand{\argmin}{\operatornamewithlimits{arg\,min}}
\newcommand{\argmax}{\operatornamewithlimits{arg\,max}}
\newcommand{\subjectto}{\operatorname{subject~to}}
\newcommand{\for}{\text{for} \;}
\newcommand{\dimension}[1]{\text{dim}\paren*{#1}}
\newcommand{\gaussian}[2]{\mathcal{N}(#1, #2)}
\newcommand{\Gaussian}[2]{\mathcal{N}\paren*{#1, #2}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Real}{\text{Re}}
\DeclareMathOperator{\Imag}{\text{Im}}
\DeclareMathOperator{\nil}{\textsc{nil}}
\DeclareMathOperator{\Expectation}{\mathbb{E}}
\DeclareMathOperator{\Variance}{\mathrm{Var}}
\DeclareMathOperator{\Normal}{\mathcal{N}}
\DeclareMathOperator{\Uniform}{\mathcal{U}}
\DeclareMathOperator{\Dirichlet}{Dir}
\DeclareMathOperator{\atantwo}{atan2}
\DeclareMathOperator{\modOne}{mod_1}
\DeclareMathOperator{\trace}{Tr}
\newcommand{\minprob}[3]{
\begin{aligned}
	\minimize_{#1} & & #2\\
	\subjectto & & #3 \\
\end{aligned}
}
\newcommand{\mat}[1]{\vect{#1}}
\renewcommand{\vec}[1]{\vect{#1}}


% Math operatrs
\DeclareMathOperator{\ReLU}{ReLU}
\DeclareMathOperator{\LeakyReLU}{LeakyReLU}
\DeclareMathOperator{\softmax}{softmax}



%%% Algorithm settings
\algtext*{EndLoop}% Remove "end _X_" text
\algtext*{EndFor}
\algtext*{EndIf}
\algtext*{EndFunction}

% Rounding notation
\DeclarePairedDelimiter{\round}\lfloor\rceil

%%% FROM CEM VARIANTS
\usepackage{tikz}
\usepackage{algorithmicx}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{siunitx}
\usepackage{commath}
% \usepackage[backend=biber,style=ieee,natbib=true]{biblatex} % TODO.
\usepackage[backend=biber,natbib=true]{biblatex} % TODO.
% \renewcommand{\bibfont}{\footnotesize} % for IEEE bibfont size TODO.
\usepackage{multirow}
\usepackage{bbm}
\usepackage[hidelinks]{hyperref}
\usepackage{cleveref}
% \usepackage[keeplastbox]{flushend} % TODO.


\usepackage{longtable,tabularx,booktabs}
\usepackage[flushleft]{threeparttable}

% Separation after algorithm environment
% \setlength{\textfloatsep}{\baselineskip} % TODO.

% \addbibresource{cem_variants.bib} % TODO

% Flipped vector arrow
\makeatletter
\DeclareRobustCommand{\cev}[1]{%
  {\mathpalette\do@cev{#1}}%
}
\newcommand{\do@cev}[2]{%
  \vbox{\offinterlineskip
    \sbox\z@{$\m@th#1 x$}%
    \ialign{##\cr
      \hidewidth\reflectbox{$\m@th#1\vec{}\mkern4mu$}\hidewidth\cr
      \noalign{\kern-\ht\z@}
      $\m@th#1#2$\cr
    }%
  }
}%late
\makeatother

\usepackage{multirow}

\usetikzlibrary{calc}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{external}
\usetikzlibrary{patterns}
\usetikzlibrary{shapes,arrows,fit}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta, calc, shapes}
\usetikzlibrary{graphs}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.pathreplacing}

\usepackage[caption=false]{subfig} % TODO?

\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{every axis legend/.append style={%
cells={anchor=west}}
}
\usetikzlibrary{arrows}
\tikzset{>=stealth'}

\usepgfplotslibrary{fillbetween}
\usepgfplotslibrary{groupplots}

\newcommand{\smallcaps}[1]{\textsc{#1}}



%%%%%% Episodic AST
% \usepackage[utf8]{inputenc}
\usepackage{fancyhdr,graphicx}
\usepackage[margin=1in]{geometry}
\usepackage[nolist]{acronym}
\usepackage{booktabs}
% \usepackage[table]{xcolor}
% \usepackage{amsmath}
% \usepackage{pgfplots}
% \usepackage{silence}
% \usepackage{tikz}
% \usepackage{algorithmicx}
% \usepackage{algorithm}
% \usepackage{algpseudocode}
% \usepackage{bm}
% \usepackage{amsfonts}
% \usepackage{siunitx}
% \usepackage{commath}
% \usepackage[hidelinks,bookmarks=false]{hyperref}
% \usepackage{cleveref}
% \usepackage{multirow}
% \usepackage{wrapfig}
% \usepackage{subfig}
% \usepackage[font=small]{caption}

\usepackage{longtable,tabularx,booktabs}
\usepackage[flushleft]{threeparttable}
\usepackage[keeplastbox]{flushend}

% \addbibresource{references.bib}

% Algorithm style.
\algtext*{EndLoop} % Remove "end _X_" text
\algtext*{EndIf}
\algtext*{EndFunction}
\renewcommand\algorithmicthen{}
\renewcommand\algorithmicdo{}

% PGFPlots and TikZ settings
\pgfplotsset{compat=newest}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{external}
\usetikzlibrary{patterns}
\usetikzlibrary{shapes,arrows,fit}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta, calc}
\usetikzlibrary{graphs}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.pathreplacing}


% Custom colors
\definecolor{pastelMagenta}{HTML}{FF48CF}
\definecolor{pastelPurple}{HTML}{8770FE}
\definecolor{pastelBlue}{HTML}{1BA1EA}
\definecolor{pastelSeaGreen}{HTML}{14B57F}
\definecolor{pastelGreen}{HTML}{3EAA0D}
\definecolor{pastelOrange}{HTML}{C38D09}
\definecolor{pastelRed}{HTML}{F5615C}
% \input{preamble/pastelcolormap} % TODO
% \input{preamble/pastelcolorlist} % TODO

% Custom commands
\newcommand{\todo}[1]{\textbf{[[TODO: #1]]}}
\crefrangelabelformat{section}{#3#1#4--#5\crefstripprefix{#1}{#2}#6} % Reference range of sections with a dash
% \newcommand{\citefull}[1]{\citeauthor{#1}~\cite{#1}}

%%% full author citation
% {\newrobustcmd*{\citefirstlastauthor}{\AtNextCite{\DeclareNameAlias{labelname}{given-family}}\citeauthor}




%% Weakness recognition
\usepackage{graphbox}       % for [align=c] in \includegraphics
\usepackage{wrapfig}
% \usepackage{subfigure}
\usepackage{caption}
% \usepackage{subcaption}
\usepackage{graphicx}






%%% POMDPStressTesting.jl
\usepackage{listings}

% \lstdefinelanguage{Julia}{
%     keywords=[3]{initialize!, transition!, evaluate!, distance, isevent, isterminal, environment},
%     keywords=[2]{Nothing, Tuple, Real, Bool, Simulation, BlackBox, GrayBox, Sampleable, Environment},
%     keywords=[1]{function, abstract, type, end},
%     sensitive=true,
%     morecomment=[l]{\#},
%     morecomment=[n]{\#=}{=\#},
%     morestring=[s]{"}{"},
%     morestring=[m]{'}{'},
%     alsoletter=!?,
%     literate={,}{{\color[HTML]{0F6FA3},}}1
%              {\{}{{\color[HTML]{0F6FA3}\{}}1
%              {\}}{{\color[HTML]{0F6FA3}\}}}1
% }

% \lstset{
%     language         = Julia,
%     backgroundcolor  = \color[HTML]{F2F2F2},
%     basicstyle       = \small\ttfamily\color[HTML]{19177C},
%     numberstyle      = \ttfamily\scriptsize\color[HTML]{7F7F7F},
%     keywordstyle     = [1]{\bfseries\color[HTML]{1BA1EA}},
%     keywordstyle     = [2]{\color[HTML]{0F6FA3}},
%     keywordstyle     = [3]{\color[HTML]{0000FF}},
%     stringstyle      = \color[HTML]{F5615C},
%     commentstyle     = \color[HTML]{AAAAAA},
%     rulecolor        = \color[HTML]{000000},
%     frame=lines,
%     xleftmargin=10pt,
%     framexleftmargin=10pt,
%     framextopmargin=4pt,
%     framexbottommargin=4pt,
%     tabsize=4,
%     captionpos=b,
%     breaklines=true,
%     breakatwhitespace=false,
%     showstringspaces=false,
%     showspaces=false,
%     showtabs=false,
%     columns=fullflexible,
%     keepspaces=true,
%     numbers=none,
% }